Homework 5 - P8105
================
Sergio Ozoria Ramírez (smo2147)
2025-11-13

# Set up

Potential packages are first loaded to use for our problem sets. Figure
preferences were used to set figure sizing and aesthetics for plotting
outputs.

``` r
library(tidyverse)
library(modelr)
library(rvest)
library(scales)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

# Problem 1

Problem set 1 outlines the function to be used to estimate the
probability of sharing a birthday in a calendar year for a group size of
2:50. A figure was plotted to observe these estimates using `ggplot`.

``` r
bday_prob = function(n) {
  
  if (!is.numeric(n) || length(n) != 1 || n < 1) {
    
    stop("n must be a single positive number") 
    
    }

  bday_samp = sample(1:365, size = n, replace = TRUE)
  
  any(duplicated(bday_samp))
  
}
```

``` r
set.seed(123)

bday_results =
  tibble(
    n = 2:50,
    bday_probability = map_dbl(
      n, \(x) mean(replicate(10000, bday_prob(x)
                             )
                   )
      )
  )

bday_results
```

    ## # A tibble: 49 × 2
    ##        n bday_probability
    ##    <int>            <dbl>
    ##  1     2           0.0033
    ##  2     3           0.0079
    ##  3     4           0.0158
    ##  4     5           0.0248
    ##  5     6           0.0387
    ##  6     7           0.057 
    ##  7     8           0.0749
    ##  8     9           0.0885
    ##  9    10           0.116 
    ## 10    11           0.140 
    ## # ℹ 39 more rows

``` r
bday_results |> 
  ggplot(aes(x = n, y = bday_probability)) +
  geom_hline(yintercept = 0.5, linetype = "dashed") +
  geom_point(color = "blue") +
  scale_y_continuous(labels = percent_format()) +
  labs(
    title = "Figure 1. Probability of Shared Birthday by Group Size",
    x = "Group size (n)",
    y = "Probability of shared birthday"
  )
```

<img src="p8105_hw5_smo2147_files/figure-gfm/figure 1-1.png" width="90%" />

## Figure 1 - Comment

Figure 1 shows that the probability of sharing a birthday increases as
the group size increases. For example, in a random group of 23 people,
there is a 50% chance that at least two people share the same birthday.
We see that the probability of shared birthdays among two people
increases closer to 100% with at least 40 people in a random sample.
This is because we’re making comparisons based on matches, so the rate
of possible shared birthdays increases at a faster rate than the group
size

# Problem 2

``` r
sim_test = function(mu, n = 30, sigma = 5) {
  
  x = rnorm(n, mean = mu, sd = sigma)
  
  t_test = t.test(x, mu = 0)
  
  broom::tidy(t_test) |> 
    select(estimate, p.value)
  
}
```

``` r
sim_mu0 = 
  tibble(
    iter = 1:5000) |> 
  mutate(
    tt_results = map(iter, \(i) sim_test(mu = 0))
  ) |> 
  unnest(tt_results)

sim_mu0
```

    ## # A tibble: 5,000 × 3
    ##     iter estimate p.value
    ##    <int>    <dbl>   <dbl>
    ##  1     1   -0.424  0.642 
    ##  2     2    1.34   0.220 
    ##  3     3   -1.85   0.0246
    ##  4     4   -0.759  0.373 
    ##  5     5   -1.03   0.259 
    ##  6     6    0.502  0.521 
    ##  7     7    0.442  0.573 
    ##  8     8   -0.539  0.593 
    ##  9     9   -0.293  0.739 
    ## 10    10    0.955  0.271 
    ## # ℹ 4,990 more rows

``` r
sim_mu_06 =
  expand_grid(
    mu = 0:6,
    iter = 1:5000
  ) |> 
  mutate(
    tt_results = map(mu, sim_test)
  ) |> 
    unnest(tt_results)

sim_mu_06
```

    ## # A tibble: 35,000 × 4
    ##       mu  iter estimate p.value
    ##    <int> <int>    <dbl>   <dbl>
    ##  1     0     1  -0.536    0.517
    ##  2     0     2  -0.678    0.431
    ##  3     0     3   0.784    0.377
    ##  4     0     4  -1.02     0.269
    ##  5     0     5   0.0464   0.953
    ##  6     0     6  -1.46     0.104
    ##  7     0     7  -0.0818   0.930
    ##  8     0     8   0.910    0.258
    ##  9     0     9   0.300    0.750
    ## 10     0    10  -0.492    0.517
    ## # ℹ 34,990 more rows

``` r
power_df =
  sim_mu_06 |> 
  group_by(mu) |> 
  summarize(power = mean(p.value < 0.05))

power_df |> 
  ggplot(aes(x = mu, y = power)) +
  geom_line(color = "skyblue") +
  geom_point(color = "blue", size = 2) +
  labs(
    title = "Figure 2. Association between Effect Zize and Power",
    x = "True population mean",
    y = "Power (Prob. of Rejection Null)"
  )
```

<img src="p8105_hw5_smo2147_files/figure-gfm/figure 2-1.png" width="90%" />

## Figure 2 - Comment

Figure 2 shows that the proportion of rejecting the null, meaning power,
increases as the true population mean moves further away from 0.
Notably, when the true population mean increases from 2 to 3, the
proportion of rejecting the null increases significantly, closer to a
power of 1
